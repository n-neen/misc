lorom

!gravram   = $05a2           ;freeram
!gravindex = $05a4

org $909c7b                  ;each of these just overwrites where samus subacceleration
    lda !gravram             ;is loaded from the table in rom
    
org $909c91
    lda !gravram
    
org $909c9f
    lda !gravram

org $828ba8
    jsr gravload             ;hijack main gameplay loop ok lol
    nop
    
org $82f70f
    gravload:
    jsl $8fe8a3              ;the thing we overwrote
    
    phx
    phy
    pha
        ldx !gravindex
        cpx #$0200           ;table length
        bpl reset
        lda gravtable,x
        sta !gravram
        inc !gravindex
        inc !gravindex
    pla
    ply
    plx
    rts
    
    reset:
    stz !gravindex
    stz !gravram
    
    pla
    ply
    plx
    rts

org $85a000                  ;gravity table
    gravtable:
    
    dw $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000       ;dwell
    dw $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
    dw $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
    dw $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000, $0000
    
    dw $0000, $0040, $0080, $00c0, $0100, $0140, $0180, $01c0, $0200, $0240, $0280, $02c0, $0300, $0340, $0380, $03c0       ;ramp up
    dw $0400, $0440, $0480, $04c0, $0500, $0540, $0580, $05c0, $0600, $0640, $0680, $06c0, $0700, $0740, $0780, $07c0
    dw $0800, $0840, $0880, $08c0, $0900, $0940, $0980, $09c0, $0a00, $0a40, $0a80, $0ac0, $0b00, $0b40, $0b80, $0bc0
    
    dw $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00       ;dwell
    dw $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00
    dw $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00
    dw $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00
    dw $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00
    dw $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00, $0c00

    dw $0bc0, $0b80, $0b40, $0b00, $0ac0, $0a80, $0a40, $0a00, $09c0, $0980, $0940, $0900, $08c0, $0880, $0840, $0800       ;ramp down
    dw $07c0, $0780, $0740, $0700, $06c0, $0680, $0640, $0600, $05c0, $0580, $0540, $0500, $04c0, $0480, $0440, $0400
    dw $03c0, $0380, $0340, $0300, $02c0, $0280, $0240, $0200, $01c0, $0180, $0140, $0100, $00c0, $0080, $0040, $0000
    